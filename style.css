:root{
  --bg:#f3faf8;
  --card:#fff;
  --accent:#66cdaa;
  --muted:#6b6b6b;
}
*{box-sizing:border-box}
body{
  font-family:Inter,Segoe UI,system-ui,Arial;
  margin:0;
  background:linear-gradient(180deg,var(--bg),#eaf7f3);
  color:#333;
  min-height:100vh;
  overflow-x:hidden;
  padding-bottom:70px;
}
header{padding:12px 16px;text-align:center}
header h1{margin:0;font-size:clamp(1.5rem, 5vw, 2rem)}
.tag{color:var(--muted);font-size:clamp(0.875rem, 3vw, 1rem);padding:0 8px}
main{
  display:flex;
  gap:20px;
  padding:16px;
  align-items:flex-start;
  max-width:1100px;
  margin:0 auto;
  width:100%;
  position:relative;
}
.game-area{
  display:flex;
  gap:20px;
  flex:1;
  background:var(--card);
  padding:18px;
  border-radius:12px;
  box-shadow:0 6px 30px rgba(100,100,100,0.08);
  width:100%;
}
.otter-display{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:16px;
}
.otter-wrapper{
  width:100%;
  max-width:340px;
  height:auto;
  aspect-ratio:340/260;
  display:flex;
  align-items:center;
  justify-content:center;
  flex-shrink:0;
}
.info{flex:1;min-width:0;width:100%}
.status .bar{margin-bottom:10px}
.status label{display:block;font-size:0.9rem;margin-bottom:6px}
.progress{background:#e6f2ef;border-radius:6px;height:12px;overflow:hidden}
.fill{height:100%;width:50%;background:linear-gradient(90deg,var(--accent),#3cb38f);transition:width 0.4s ease, background 0.3s}
.fill.low{background:linear-gradient(90deg,#ff9966,#ff6b6b)}
.fill.critical{background:linear-gradient(90deg,#ff4757,#d63031);animation:pulse 1s ease-in-out infinite}
.controls{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
.controls button{
  padding:12px 16px;
  border-radius:8px;
  border:1px solid rgba(0,0,0,0.06);
  background:#fff;
  cursor:pointer;
  font-size:0.95rem;
  flex:1 1 calc(50% - 4px);
  min-width:120px;
  transition:all 0.2s;
}
.controls button:hover{transform:translateY(-2px);box-shadow:0 2px 8px rgba(102,205,170,0.2)}
.controls button:active{transform:scale(0.98)}
.btn-secondary{
  background:#f5f5f5;
  color:#666;
  font-size:0.85rem;
  padding:8px 12px;
  border:1px solid rgba(0,0,0,0.06);
  border-radius:6px;
  cursor:pointer;
}
.meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px;flex-wrap:wrap;gap:8px}
.coins{font-weight:700;font-size:1rem}
.shop{
  width:100%;
  background:var(--card);
  padding:16px;
  border-radius:12px;
  box-shadow:0 6px 30px rgba(100,100,100,0.06);
}
.shop h2{margin-top:0;font-size:1.3rem}
.item{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px;gap:8px;padding:12px;background:#f9f9f9;border-radius:8px}
.item-icon{font-size:2rem}
.item-info{flex:1;font-size:0.95rem}
.buy{padding:8px 16px;border-radius:8px;font-size:0.9rem;white-space:nowrap;background:var(--accent);color:white;border:none;cursor:pointer;font-weight:600}
.buy:hover{background:#5bb899}

.stats-content{padding:16px;display:flex;flex-direction:column;gap:12px}
.analytics-area{margin-top:12px;padding:12px;border-radius:10px;background:#f2f7f5;border:1px dashed rgba(102,205,170,0.35)}
.analytics-toggle{display:flex;align-items:center;gap:10px;color:#33605a;font-size:0.9rem}
.analytics-toggle input{width:18px;height:18px;accent-color:var(--accent)}
.analytics-summary{margin:8px 0 0;font-size:0.85rem;color:#5f6d69}
.stats-note{margin-top:18px;color:#666;font-size:0.9rem}

.alert-banner{position:fixed;top:16px;left:50%;transform:translateX(-50%);background:var(--card);padding:10px 18px;border-radius:999px;box-shadow:0 12px 30px rgba(0,0,0,0.15);z-index:1400;font-weight:600;color:#1b4f4b;max-width:90%;text-align:center}
.alert-banner[data-variant="warning"]{background:#ffe9e3;color:#a44932}
.alert-banner[data-variant="info"]{background:#e0f5ef;color:#1f675b}

.update-banner{position:fixed;bottom:calc(70px + 16px);left:50%;transform:translateX(-50%);background:var(--card);padding:12px 16px;border-radius:14px;box-shadow:0 -8px 24px rgba(0,0,0,0.12);display:flex;align-items:center;gap:16px;max-width:420px;width:calc(100% - 32px);z-index:1300}
.update-actions{display:flex;gap:8px}
.update-banner button{padding:10px 14px;border-radius:8px;border:none;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
.update-banner .btn-secondary{background:#f5f5f5;color:#333;border:1px solid rgba(0,0,0,0.08)}

.tutorial{position:fixed;inset:0;background:rgba(9,35,32,0.78);display:flex;align-items:center;justify-content:center;z-index:2000;padding:24px}
.tutorial-card{background:#ffffff;border-radius:18px;padding:24px;max-width:420px;width:100%;display:flex;flex-direction:column;gap:16px;box-shadow:0 24px 60px rgba(0,0,0,0.2)}
.tutorial-card h2{margin:0;font-size:1.4rem;color:#2c4b47}
.tutorial-card ul{margin:0;padding-left:20px;display:flex;flex-direction:column;gap:8px;color:#3d5a56;font-size:0.95rem}
.tutorial-start{background:var(--accent);color:#fff;border:none;padding:12px;border-radius:10px;font-weight:600;cursor:pointer}
.tutorial-start:hover{background:#5bb899}
.tutorial-toggle{display:flex;align-items:center;gap:10px;color:#2f5b55;font-size:0.9rem}
.tutorial-toggle input{width:18px;height:18px;accent-color:var(--accent)}

body.overlay-active{overflow:hidden}

/* Page content */
.page-content{
  width:100%;
  max-width:1100px;
  margin:0 auto;
  padding:16px;
}

/* Bottom Navigation (mobile-first) */
.bottom-nav{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  background:var(--card);
  border-top:1px solid rgba(0,0,0,0.08);
  display:none;
  justify-content:space-around;
  padding:8px 0 calc(8px + env(safe-area-inset-bottom));
  z-index:100;
  box-shadow:0 -2px 10px rgba(0,0,0,0.05);
}
.nav-btn{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:4px;
  background:none;
  border:none;
  padding:8px 12px;
  cursor:pointer;
  color:#666;
  transition:all 0.2s;
}
.nav-btn.active{
  color:var(--accent);
}
.nav-icon{
  font-size:24px;
  transition:transform 0.2s;
}
.nav-btn.active .nav-icon{
  transform:scale(1.2);
}
.nav-label{
  font-size:0.7rem;
  font-weight:500;
}

/* Hide pages by default on mobile */
#shopPage{
  display:none;
}
#shopPage.active{
  display:block;
}
#mainInfo.hidden{
  display:none;
}
.overlay{position:fixed;inset:0;background:rgba(0,0,0,0.4);display:flex;align-items:center;justify-content:center;z-index:1000;padding:16px}
.hidden{display:none}
.minigame{
  background:#fff;
  padding:18px;
  border-radius:12px;
  width:100%;
  max-width:420px;
}
.minigame h3{font-size:clamp(1rem, 4vw, 1.2rem);margin-top:0}
.fish-area{width:100%;height:180px;background:linear-gradient(#b8e1ff,#fff);border-radius:8px;position:relative;overflow:hidden;margin-top:6px}
.fish{position:absolute;font-size:28px;cursor:pointer;-webkit-user-select:none;user-select:none}
.mini-info{margin-top:8px}
footer{padding:6px;text-align:center;font-size:0.8rem;margin-top:10px;color:var(--muted)}
/* Otter animations */
#otterSvg{transition:transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)}
#otterSvg.hop{transform:translateY(-15px) scale(1.05)}
#otterSvg.rest{filter:grayscale(40%) brightness(0.9)}
#otterSvg.eating{animation:eatBob 0.5s ease-in-out 3}
#otterSvg.bathing{animation:bathShake 0.4s ease-in-out 4}

/* Eye animations */
#eyes{transition:transform 0.15s ease}
#otterSvg.blink #leftPupil, #otterSvg.blink #rightPupil{transform:scaleY(0.2);transform-origin:center;transition:transform 0.1s}

/* Emotion states - handled via JS for cross-browser compat */
#otterSvg.happy #blushLeft, #otterSvg.happy #blushRight{opacity:0.4;transition:opacity 0.3s}
#otterSvg.sleepy #eyes{transform:scaleY(0.4);transform-origin:center}
#otterSvg.feeding #foodItem{opacity:1;animation:foodFloat 1.5s ease-out}

/* Tail wag */
#tail{transform-origin:165px 95px;transition:transform 0.2s ease}
#otterSvg.happy #tail{animation:tailWag 0.6s ease-in-out infinite}

/* Keyframe animations */
@keyframes eatBob{0%,100%{transform:translateY(0)}50%{transform:translateY(-8px)}}
@keyframes bathShake{0%,100%{transform:rotate(0deg)}25%{transform:rotate(-3deg)}75%{transform:rotate(3deg)}}
@keyframes tailWag{0%,100%{transform:rotate(-15deg)}50%{transform:rotate(-5deg)}}
@keyframes foodFloat{0%{transform:translateY(0) scale(1);opacity:1}100%{transform:translateY(-30px) scale(0.5);opacity:0}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.7}}

/* hat style */
.hat{font-size:24px;pointer-events:none;position:absolute;left:50px;top:18px;filter:drop-shadow(0 2px 4px rgba(0,0,0,0.2))}

/* Mobile responsiveness */
@media (max-width:820px){
  main{flex-direction:column;gap:16px;padding:12px}
  .game-area{flex-direction:column;padding:16px;gap:16px}
  .otter-wrapper{
    width:100%;
    max-width:340px;
    height:auto;
    aspect-ratio:340/260;
    margin:0 auto;
  }
  .info{width:100%}
  .controls button{
    padding:12px 16px;
    font-size:1rem;
    min-width:0;
  }
  .shop{width:100%;order:2}
  .minigame{padding:16px}
  .fish-area{height:240px}
}

@media (max-width:480px){
  header h1{font-size:1.5rem}
  .tag{font-size:0.85rem}
  main{padding:8px;gap:12px}
  .game-area{padding:12px;gap:12px}
  .otter-wrapper{
    max-width:280px;
  }
  .controls{gap:6px}
  .controls button{
    padding:10px 12px;
    font-size:0.9rem;
    flex:1 1 100%;
  }
  .status label{font-size:0.85rem}
  .shop h2{font-size:1.1rem}
  .item-icon{font-size:1.5rem}
  .item-info{font-size:0.85rem}
  .fish{font-size:24px}
  footer{font-size:0.75rem}
  .bottom-nav{display:flex}
  body{padding-bottom:70px}
  .update-banner{flex-direction:column;align-items:stretch;gap:12px;text-align:center}
  .update-actions{width:100%;justify-content:center}
  .update-banner button{width:100%}
  .alert-banner{max-width:95%;top:12px}
}

/* Landscape mobile */
@media (max-width:820px) and (orientation:landscape){
  .game-area{flex-direction:row}
  .otter-wrapper{
    width:50%;
    max-width:300px;
  }
  .info{width:50%}
}

/* Touch improvements */
@media (hover:none){
  .controls button:hover{transform:none}
  .controls button:active{
    background:#f0f0f0;
    transform:scale(0.98);
  }
}
